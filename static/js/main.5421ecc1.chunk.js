(this["webpackJsonpstarter-kit"]=this["webpackJsonpstarter-kit"]||[]).push([[0],{18:function(t,e,n){},189:function(t,e,n){"use strict";n.r(e);var a=n(1),i=n(5),o=n.n(i),r=n(78),c=n.n(r),s=(n(85),n(33)),u=n.n(s),l=n(79),p=n(9),d=n(10),h=n(7),m=n(12),v=n(11),j=(n(18),n(22)),f=function(t){Object(m.a)(n,t);var e=Object(v.a)(n);function n(t){var a;return Object(p.a)(this,n),(a=e.call(this,t)).ref=o.a.createRef(),a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){if(null!==this.props.track){var t=this.props.track.attach();this.ref.current.classList.add(this.props.track.kind),this.ref.current.appendChild(t)}}},{key:"render",value:function(){return Object(a.jsx)("div",{className:"track",ref:this.ref})}}]),n}(i.Component),b=function(t){Object(m.a)(n,t);var e=Object(v.a)(n);function n(t){var a;Object(p.a)(this,n),a=e.call(this,t);var i=Array.from(a.props.participant.tracks.values()).map((function(t){return t.track})).filter((function(t){return null!==t}));return a.state={tracks:i},a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=this;this.props.localParticipant||this.props.participant.on("trackSubscribed",(function(e){return t.addTrack(e)}))}},{key:"addTrack",value:function(t){this.setState({tracks:[].concat(Object(j.a)(this.state.tracks),[t])})}},{key:"render",value:function(){return Object(a.jsxs)("div",{className:"participant",id:this.props.participant.identity,children:[Object(a.jsx)("div",{className:"identity",children:this.props.participant.identity}),this.state.tracks.map((function(t){return Object(a.jsx)(f,{track:t},t)}))]})}}]),n}(i.Component),k=function(t){Object(m.a)(n,t);var e=Object(v.a)(n);function n(t){var a;return Object(p.a)(this,n),(a=e.call(this,t)).state={remoteParticipants:Array.from(a.props.room.participants.values())},a.leaveRoom=a.leaveRoom.bind(Object(h.a)(a)),a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=this;this.props.room.on("participantConnected",(function(e){return t.addParticipant(e)})),this.props.room.on("participantDisconnected",(function(e){return t.removeParticipant(e)})),window.addEventListener("beforeunload",this.leaveRoom)}},{key:"componentWillUnmount",value:function(){this.leaveRoom()}},{key:"leaveRoom",value:function(){this.props.room.disconnect(),this.props.leaveRoom()}},{key:"addParticipant",value:function(t){console.log("".concat(t.identity," has joined the room.")),this.setState({remoteParticipants:[].concat(Object(j.a)(this.state.remoteParticipants),[t])})}},{key:"removeParticipant",value:function(t){console.log("".concat(t.identity," has left the room")),this.setState({remoteParticipants:this.state.remoteParticipants.filter((function(e){return e.identity!==t.identity}))})}},{key:"render",value:function(){return Object(a.jsxs)("div",{className:"room",children:[Object(a.jsxs)("div",{className:"participants",children:[Object(a.jsx)(b,{localParticipant:"true",participant:this.props.room.localParticipant},this.props.room.localParticipant.identity),this.state.remoteParticipants.map((function(t){return Object(a.jsx)(b,{participant:t},t.identity)}))]}),Object(a.jsx)("button",{id:"leaveRoom",onClick:this.leaveRoom,children:"Leave Room"})]})}}]),n}(i.Component),y=n(87).connect,O=function(t){Object(m.a)(n,t);var e=Object(v.a)(n);function n(t){var a;return Object(p.a)(this,n),(a=e.call(this,t)).state={identity:"",room:null},a.inputRef=o.a.createRef(),a.joinRoom=a.joinRoom.bind(Object(h.a)(a)),a.leaveRoom=a.leaveRoom.bind(Object(h.a)(a)),a.updateIdentity=a.updateIdentity.bind(Object(h.a)(a)),a.removePlaceholderText=a.removePlaceholderText.bind(Object(h.a)(a)),a}return Object(d.a)(n,[{key:"joinRoom",value:function(){var t=Object(l.a)(u.a.mark((function t(){var e,n,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("https://token-service-8705-dev.twil.io/token\n?identity=".concat(this.state.identity));case 3:return e=t.sent,t.next=6,e.json();case 6:return n=t.sent,t.next=9,y(n.accessToken,{name:"cool-room",audio:!0,video:!0});case 9:a=t.sent,this.setState({room:a}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),console.log(t.t0);case 16:case"end":return t.stop()}}),t,this,[[0,13]])})));return function(){return t.apply(this,arguments)}}()},{key:"leaveRoom",value:function(){this.setState({room:null})}},{key:"updateIdentity",value:function(t){this.setState({identity:t.target.value})}},{key:"removePlaceholderText",value:function(){this.inputRef.current.placeholder=""}},{key:"render",value:function(){var t=""===this.state.identity;return Object(a.jsx)("div",{className:"app",children:null===this.state.room?Object(a.jsxs)("div",{className:"lobby",children:[Object(a.jsx)("input",{ref:this.inputRef,value:this.state.identity,onClick:this.removePlaceholderText,onChange:this.updateIdentity,placeholder:"What's your name?"}),Object(a.jsx)("button",{disabled:t,onClick:this.joinRoom,children:"Join Room"})]}):Object(a.jsx)(k,{leaveRoom:this.leaveRoom,room:this.state.room})})}}]),n}(i.Component),x=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,190)).then((function(e){var n=e.getCLS,a=e.getFID,i=e.getFCP,o=e.getLCP,r=e.getTTFB;n(t),a(t),i(t),o(t),r(t)}))};c.a.render(Object(a.jsx)(o.a.StrictMode,{children:Object(a.jsx)(O,{})}),document.getElementById("root")),x()},85:function(t,e,n){}},[[189,1,2]]]);
//# sourceMappingURL=main.5421ecc1.chunk.js.map